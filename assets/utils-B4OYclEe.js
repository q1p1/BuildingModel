const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-Bf5s4k-S.js","assets/index-CSwUTS8E.js"])))=>i.map(i=>d[i]);
import{$ as i,k1 as M,k2 as C,k3 as g,k4 as k,k5 as S,gy as L,fy as y,k6 as h,gZ as E,k7 as x,_ as z,k8 as G}from"./index-CSwUTS8E.js";function I(e,t,o,n){if(e)if(e.type!=="CIMTextSymbol"){if(e.effects)for(const r of e.effects)A(r,t);if(e.symbolLayers)for(const r of e.symbolLayers)switch(r.type){case"CIMPictureMarker":case"CIMVectorMarker":T(r,t,n);break;case"CIMPictureStroke":case"CIMSolidStroke":!(n!=null&&n.preserveOutlineWidth)&&r.width&&(r.width*=t);break;case"CIMPictureFill":r.height&&(r.height*=t),r.offsetX&&(r.offsetX*=t),r.offsetY&&(r.offsetY*=t);break;case"CIMHatchFill":I(r.lineSymbol,t,!0,{...n,preserveOutlineWidth:!1}),r.offsetX&&(r.offsetX*=t),r.offsetY&&(r.offsetY*=t),r.separation&&(r.separation*=t)}}else e.height!=null&&(e.height*=t)}function T(e,t,o){if(e&&(e.markerPlacement&&O(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&e.anchorPointUnits==="Absolute"&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=e.size!=null?e.size*t:0,e.type==="CIMVectorMarker"&&e.markerGraphics))for(const n of e.markerGraphics)e.scaleSymbolsProportionally||I(n.symbol,t,!0,o)}function O(e,t){switch(k(e)&&e.offset&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map(n=>n*t);e.placementTemplate=o}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset&&(e.maxRandomOffset*=t),e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map(n=>n*t);e.placementTemplate=o}break;case"CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=t);break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=t);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition&&(e.beginPosition*=t),e.endPosition&&(e.endPosition*=t);break;case"CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.stepX&&(e.stepX*=t),e.stepY&&(e.stepY*=t)}}function A(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width&&(e.width*=t);break;case"CIMGeometricEffectBuffer":e.size&&(e.size*=t);break;case"CIMGeometricEffectCut":e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case"CIMGeometricEffectDashes":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length){const o=e.dashTemplate.map(n=>n*t);e.dashTemplate=o}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length&&(e.length*=t);break;case"CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=t);break;case"CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=t);break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case"CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function $(e){const t=[];return p(M(e),t),t.length?new i(S(t[0])):null}function p(e,t){var r;if(!e)return;let o;o=e.type==="CIMTextSymbol"?e.symbol:e;const n=e.type==="CIMPolygonSymbol";if(o!=null&&o.symbolLayers){for(const a of o.symbolLayers)if(!(a.colorLocked||n&&(C(a)||g(a)&&a.markerPlacement&&k(a.markerPlacement))))switch(a.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":a.tintColor&&d(t,a.tintColor);break;case"CIMVectorMarker":(r=a.markerGraphics)==null||r.forEach(s=>{p(s.symbol,t)});break;case"CIMSolidStroke":case"CIMSolidFill":d(t,a.color);break;case"CIMHatchFill":p(a.lineSymbol,t)}}}function d(e,t){for(const o of e)if(o.join(".")===t.join("."))return;e.push(t)}function B(e,t,o){t instanceof i||(t=new i(t));const n=M(e);n&&b(n,t)}function b(e,t,o){var a;if(!e)return;let n;n=e.type==="CIMTextSymbol"?e.symbol:e;const r=(n==null?void 0:n.type)==="CIMPolygonSymbol";if(n!=null&&n.symbolLayers)for(const s of n.symbolLayers){if(s.colorLocked||r&&(C(s)||g(s)&&s.markerPlacement&&k(s.markerPlacement)))continue;const l=t.toArray();switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor=l;break;case"CIMVectorMarker":(a=s.markerGraphics)==null||a.forEach(c=>{b(c.symbol,t)});break;case"CIMSolidStroke":case"CIMSolidFill":s.color=l;break;case"CIMHatchFill":b(s.lineSymbol,t)}}}new L(1e3);new i([128,128,128]);const X=new i("white");function N(e){if(e==null||!("symbolLayers"in e)||e.symbolLayers==null)return!1;switch(e.type){case"point-3d":return e.symbolLayers.some(t=>t.type==="object");case"line-3d":return e.symbolLayers.some(t=>t.type==="path");case"polygon-3d":return e.symbolLayers.some(t=>t.type==="object"||t.type==="extrude");default:return!1}}function Z(e){var t;return((t=e.resource)==null?void 0:t.href)??""}function q(e,t){if(!e)return null;let o=null;return y(e)?o=Y(e):h(e)&&(o=e.type==="cim"?$(e):e.color?new i(e.color):null),o?m(o,t):null}function Y(e){const t=e.symbolLayers;if(!t)return null;let o=null;return t.forEach(n=>{var r;n.type==="object"&&((r=n.resource)!=null&&r.href)||(o=n.type==="water"?n.color:n.material?n.material.color:null)}),o?new i(o):null}function m(e,t){if(t==null||e==null)return e;const o=e.toRgba();return o[3]=o[3]*t,new i(o)}function v(e,t,o){const n=e.symbolLayers;if(!n)return;const r=a=>m(t=t??a??(o!=null?X:null),o);n.forEach(a=>{var s,l;if(a.type!=="object"||!((s=a.resource)!=null&&s.href)||t)if(a.type==="water")a.color=r(a.color);else{const c=a.material!=null?a.material.color:null,f=r(c);a.material==null?a.material=new G({color:f}):a.material.color=f,o!=null&&"outline"in a&&((l=a.outline)==null?void 0:l.color)!=null&&(a.outline.color=m(a.outline.color,o))}})}function j(e,t,o){var n;(t=t??e.color)&&(e.color=m(t,o)),o!=null&&"outline"in e&&((n=e.outline)!=null&&n.color)&&(e.outline.color=m(e.outline.color,o))}function K(e,t,o){e&&(t||o!=null)&&(t&&(t=new i(t)),y(e)?v(e,t,o):h(e)&&j(e,t,o))}async function R(e,t){const o=e.symbolLayers;o&&await E(o,async n=>F(n,t))}async function F(e,t){switch(e.type){case"extrude":V(e,t);break;case"icon":case"line":case"text":_(e,t);break;case"path":D(e,t);break;case"object":await W(e,t)}}function _(e,t){const o=P(t);o!=null&&(e.size=o)}function P(e){for(const t of e)if(typeof t=="number")return t;return null}function V(e,t){e.size=typeof t[2]=="number"?t[2]:0}async function W(e,t){const{resourceSize:o,symbolSize:n}=await H(e),r=w(t,o,n);e.width=u(t[0],n[0],o[0],r),e.depth=u(t[1],n[1],o[1],r),e.height=u(t[2],n[2],o[2],r)}function D(e,t){const o=w(t,x,[e.width,void 0,e.height]);e.width=u(t[0],e.width,1,o),e.height=u(t[2],e.height,1,o)}function w(e,t,o){for(let n=0;n<3;n++){const r=e[n];switch(r){case"symbol-value":{const a=o[n];return a!=null?a/t[n]:1}case"proportional":break;default:if(r&&t[n])return r/t[n]}}return 1}async function H(e){const{computeObjectLayerResourceSize:t}=await z(()=>import("./symbolLayerUtils-Bf5s4k-S.js"),__vite__mapDeps([0,1])),o=await t(e,10),{width:n,height:r,depth:a}=e,s=[n,a,r];let l=1;for(let c=0;c<3;c++){const f=s[c];if(f!=null){l=f/o[c];break}}for(let c=0;c<3;c++)s[c]==null&&(s[c]=o[c]*l);return{resourceSize:o,symbolSize:s}}function u(e,t,o,n){switch(e){case"proportional":return o*n;case"symbol-value":return t??o;default:return e}}function U(e,t){const o=P(t);if(o!=null)switch(e.type){case"simple-marker":e.size=o;break;case"picture-marker":{const n=e.width/e.height;n>1?(e.width=o,e.height=o*n):(e.width=o*n,e.height=o);break}case"simple-line":e.width=o;break;case"text":e.font.size=o}}async function Q(e,t){if(e&&t)return y(e)?R(e,t):void(h(e)&&U(e,t))}function ee(e,t,o){if(e&&t!=null)if(y(e)){const n=e.symbolLayers;n&&n.forEach(r=>{if(r.type==="object")switch(o){case"tilt":r.tilt=(r.tilt??0)+t;break;case"roll":r.roll=(r.roll??0)+t;break;default:r.heading=(r.heading??0)+t}r.type==="icon"&&(r.angle+=t)})}else h(e)&&(e.type!=="simple-marker"&&e.type!=="picture-marker"&&e.type!=="text"||(e.angle+=t))}function te(e){return e!=null&&e.type==="polygon-3d"&&e.symbolLayers.some(t=>t.type==="extrude")}async function oe(e,t){return await e.fetchSymbol(t)||e.fetchCIMSymbol(t)}export{ee as D,B as I,te as J,oe as N,Q as R,K as g,q as h,I as l,Z as p,N as y};
