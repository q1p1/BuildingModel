import{d1 as D,d2 as E,d3 as I,ba as c,d4 as f,d5 as A,d6 as R,d7 as T,d8 as g,d9 as w,da as F,db as d,dc as O,cz as b}from"./index-CBbuaskE.js";function j(t,a,n=null){const e=[],l=a.mapPositions;m(a,e);const r=e[0][1].data,i=e[0][1].indices.length,o=D(i);return y(a,e,o),U(a,e,o),v(a,e,o),S(a,e,o),z(a,e,o),C(a,e,o),L(a,e,r),new E(t,e,l,I.Line,n)}function m(t,a){const{attributeData:{position:n},removeDuplicateStartEnd:e}=t,l=N(n)&&e,r=n.length/3-(l?1:0),i=new Array(2*(r-1)),o=l?n.slice(0,-3):n;let u=0;for(let p=0;p<r-1;p++)i[u++]=p,i[u++]=p+1;a.push([c.POSITION,new f(o,i,3,l)])}function y(t,a,n){if(t.attributeData.colorFeature!=null)return;const e=t.attributeData.color;a.push([c.COLOR,new f(e??A,n,4)])}function v(t,a,n){t.attributeData.normal&&a.push([c.NORMAL,new f(t.attributeData.normal,n,3)])}function S(t,a,n){t.attributeData.colorFeature!=null&&a.push([c.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],n,1,!0)])}function U(t,a,n){t.attributeData.sizeFeature==null&&a.push([c.SIZE,new f([t.attributeData.size??1],n,1,!0)])}function z(t,a,n){t.attributeData.sizeFeature!=null&&a.push([c.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],n,1,!0)])}function C(t,a,n){t.attributeData.opacityFeature!=null&&a.push([c.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],n,1,!0)])}function L(t,a,n){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==R.Global||!t.overlayInfo.spatialReference.isGeographic)return;const e=T(n.length),l=g(t.overlayInfo.spatialReference);for(let s=0;s<e.length;s+=3)w(n,s,e,s,l);const r=n.length/3,i=F(r+1);let o=B,u=G,p=0,h=0;d(o,e[h++],e[h++]),h++,i[0]=0;for(let s=1;s<r+1;++s)s===r&&(h=0),d(u,e[h++],e[h++]),h++,p+=O(o,u),i[s]=p,[o,u]=[u,o];a.push([c.DISTANCETOSTART,new f(i,a[0][1].indices,1,!0)])}function N(t){const a=t.length;return t[0]===t[a-3]&&t[1]===t[a-2]&&t[2]===t[a-1]}const B=b(),G=b();function H(t,a){if(t==null||t.length===0)return[];const n=[];return t.forEach(e=>{const l=e.length,r=T(3*l);e.forEach((o,u)=>{r[3*u]=o[0],r[3*u+1]=o[1],r[3*u+2]=o[2]});const i={attributeData:{position:r,normal:a},removeDuplicateStartEnd:!1};n.push(i)}),n}export{H as R,j as b};
