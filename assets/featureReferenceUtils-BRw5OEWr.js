import{dg as w,e0 as R,dq as T,e1 as h,dG as q,df as A,e2 as H,bH as I,e3 as L,e4 as O}from"./index-Dimyyb88.js";function k(e,n){return f(e)===f(n)}function f(e){if(e==null)return null;const n=e.layer!=null?e.layer.id:"";let t=null;return t=e.objectId!=null?e.objectId:e.layer!=null&&"objectIdField"in e.layer&&e.layer.objectIdField!=null&&e.attributes!=null?e.attributes[e.layer.objectIdField]:e.uid,t==null?null:`o-${n}-${t}`}const z={json:{write:{writer:P,target:{"feature.layerId":{type:[Number,String]},"feature.objectId":{type:[Number,String]}}},origins:{"web-scene":{read:x}}}};function P(e,n){var t;((t=e==null?void 0:e.layer)==null?void 0:t.objectIdField)!=null&&e.attributes!=null&&(n.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})}function x(e){if(e.layerId!=null&&e.objectId!=null)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}function B(e,n,t,l){const{sceneIntersectionHelper:F}=e,{observer:j,observerFeatureId:i,targetFeatureId:s,target:y}=t;if(i==null&&s==null)return;l||(l=r=>r),R(d,j,y);const a=T(d),c=1;h(d,j,d,c/a);const N=q(d,y,M);n.options.store=A.ALL,F.intersectToolIntersectorRay(N,n);let g=null,m=null,o=null,u=null;for(const r of n.results.all){const S=H(r,e);if(S==null||r.distanceInRenderSpace==null)continue;const b=f(S);b!=null&&(i!=null&&b===i&&(g??(g=l(p(r,e,a))),r.distanceInRenderSpace-c<g&&(o=r)),s!=null&&b===s&&(m??(m=l(p(r,e,a))),u==null&&r.distanceInRenderSpace-c<a&&a-r.distanceInRenderSpace+c<m&&(u=r)))}const{observerAdjusted:v,targetAdjusted:$}=t;o!=null&&o.getIntersectionPoint(v)?t.observerSurfaceNormal=o.getTransformedNormal(I()):t.observerSurfaceNormal=null,u!=null&&u.getIntersectionPoint($)?t.targetSurfaceNormal=u.getTransformedNormal(I()):t.targetSurfaceNormal=null}function p(e,n,t){if(L(e)){const l=O(e,n);if(l!=null)return Math.min(l*G,t)}return 1e-5*t}const G=.05,M=w(),d=I();export{z as b,k as c,f as d,B as m};
