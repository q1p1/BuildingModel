import{c5 as O,c6 as R,c7 as L}from"./index-HdUx8m3z.js";function E(f,n,e){const l=Array.isArray(f),r=l?f.length/n:f.byteLength/(4*n),A=l?f:new Uint32Array(f,0,r*n),g=(e==null?void 0:e.minReduction)??0,y=(e==null?void 0:e.originalIndices)||null,q=y?y.length:0,c=(e==null?void 0:e.componentOffsets)||null;let b=0;if(c)for(let t=0;t<c.length-1;t++){const a=c[t+1]-c[t];a>b&&(b=a)}else b=r;const w=Math.floor(1.1*b)+1;(h==null||h.length<2*w)&&(h=new Uint32Array(O(2*w)));for(let t=0;t<2*w;t++)h[t]=0;let i=0;const U=!!c&&!!y,m=U?q:r;let s=R(r);const d=new Uint32Array(q),k=1.96;let I=g!==0?Math.ceil(4*k*k/(g*g)*g*(1-g)):m,p=1,$=c?c[1]:m;for(let t=0;t<m;t++){if(t===I){const o=1-i/t;if(o+k*Math.sqrt(o*(1-o)/t)<g)return null;I*=2}if(t===$){for(let o=0;o<2*w;o++)h[o]=0;if(y)for(let o=c[p-1];o<c[p];o++)d[o]=s[y[o]];$=c[++p]}const a=U?y[t]:t,j=a*n,x=B(A,j,n);let u=x%w,C=i;for(;h[2*u+1]!==0;){if(h[2*u]===x){const o=h[2*u+1]-1;if(v(A,j,o*n,n)){C=s[o];break}}u++,u>=w&&(u-=w)}C===i&&(h[2*u]=x,h[2*u+1]=a+1,i++),s[a]=C}if(g!==0&&1-i/r<g)return null;if(U){for(let t=c[p-1];t<d.length;t++)d[t]=s[y[t]];s=L(d)}const M=l?new Array(i):new Uint32Array(i*n);i=0;for(let t=0;t<m;t++)s[t]===i&&(z(A,(U?y[t]:t)*n,M,i*n,n),i++);if(y&&!U){const t=new Uint32Array(q);for(let a=0;a<t.length;a++)t[a]=s[y[a]];s=L(t)}return{buffer:Array.isArray(M)?M:M.buffer,indices:s,uniqueCount:i}}function v(f,n,e,l){for(let r=0;r<l;r++)if(f[n+r]!==f[e+r])return!1;return!0}function z(f,n,e,l,r){for(let A=0;A<r;A++)e[l+A]=f[n+A]}function B(f,n,e){let l=0;for(let r=0;r<e;r++)l=f[n+r]+l|0,l=l+(l<<11)+(l>>>2)|0;return l>>>0}let h=null;export{E as e};
